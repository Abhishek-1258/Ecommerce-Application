package com.example.ecommerce.service;

import org.springframework.http.ResponseEntity;
import org.springframework.stereotype.Service;

import com.example.ecommerce.dto.CartItemRequest;
import com.example.ecommerce.dto.CartItemResponse;
import com.example.ecommerce.dto.ProductResponseDTO;
import com.example.ecommerce.exceptions.CartNotFoundException;
import com.example.ecommerce.exceptions.ProductNotFoundException;
import com.example.ecommerce.model.Cart;
import com.example.ecommerce.model.CartItem;
import com.example.ecommerce.model.Product;
import com.example.ecommerce.repository.CartRepository;
import com.example.ecommerce.repository.ProductRepository;

import jakarta.validation.Valid;

@Service
public class CartService {
	
	private final CartRepository cartRepository;
	
	private final ProductRepository productRepository;
	
	
	
	public CartService(CartRepository cartRepository,ProductRepository productRepository) {
		this.cartRepository = cartRepository;
		this.productRepository = productRepository;
	}

	public ResponseEntity addToCart(CartItemRequest cartItemRequest) {
		Cart cart = cartRepository.findById(cartItemRequest.getCartId()).orElseThrow(() -> new CartNotFoundException("Cart Id was not found"));
		User user = cartRepository.findUserByUserId(cartItemRequest.getUserId()).get();
		Product product = productRepository.findById(cartItemRequest.getProductId()).orElseThrow(() -> new ProductNotFoundException("Product was not found"));
		CartItem cartItem = CartItem.builder()
				.cart(cart)
				.product(product)
				.price(product.getPrice())
				.quantity(cartItemRequest.getQuantity())
				.build();
		return null;
	}


	public CartItemResponse getCart(Long userId) {
		
		return null;
	}

	public void deleteCartItem(Long cartItemId, Long userId) {
		
		
	}


	public void updateCartItem(@Valid CartItemRequest cartItemRequest, Long userId, ProductResponseDTO product) {
		// TODO Auto-generated method stub
		
	}

}
